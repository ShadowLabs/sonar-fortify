<h2>ABSTRACT</h2>
<p>
  Concatenating unvalidated input into a URL can allow an attacker to override the value of a request parameter.  Attacker may be able to override existing parameter values, inject a new parameter or exploit variables out of a direct reach.
</p>
<h2>EXPLANATION</h2>
<p>
  HTTP Parameter Pollution (HPP) attacks consist of injecting encoded query string delimiters into other existing parameters. If a web application does not properly sanitize the user input, a malicious user can compromise the logic of the application to perform either client-side or server-side attacks. By submitting additional parameters to a web application, and if these parameters have the same name as an existing parameter, the web application may be react in one of the following ways<br /><br />    It may only take the data from the first parameter<br />    It may take the data from the last parameter<br />    It may take the data from all parameters and concatenate them together<br /><br /><pre><br />Technology/HTTP back-end		Overall Parsing Result						Example<br />ASP.NET/IIS						All occurrences of the specific parameter	par1=val1,val2<br />ASP/IIS							All occurrences of the specific parameter	par1=val1,val2<br />PHP/Apache						Last occurrence								par1=val2<br />JSP,Servlet/Apache Tomcat		First occurrence							par1=val1<br />JSP,Servlet/Oracle <br />Application Server 10g			First occurrence							par1=val1<br />IBM HTTP Server					First occurrence							par1=val1<br />mod_perl/Apache					Becomes an array							ARRAY(0x8b9059c)<br /></pre><br /><br /><b>Example 1:</b> Depending on the application server and the logic of the application itself, the following request might cause confusion to the authentication system and allow an attacker to impersonate another user.<br />http://www.server.com/login.php?name=alice&amp;name=hacker<br /><br /><pre><br />    &lt;%<br />        ...<br />        $id = $_GET["id"];<br />        header("Location: http://www.host.com/election.php?poll_id=" . $id);<br />        ...<br />    %&gt;<br /></pre><br /><br /><b>Example 2:</b> The following code uses input from an HTTP request to render two hyperlinks.<br />URL:	http://www.host.com/election.php?poll_id=4567<br />Link1:	&lt;a href="vote.php?poll_id=4567&amp;candidate=white"&gt;Vote for Mr. White&lt;a&gt;<br />Link2:	&lt;a href="vote.php?poll_id=4567&amp;candidate=green"&gt;Vote for Mrs. Green&lt;a&gt;<br /><br />The programmer has not considered the possibility that an attacker could provide a poll_id such as "4567&amp;candidate=green", and then the resulting page will contain the following injected links and hence Mrs. Green will always voted on a application server which picks the first parameter.<br />&lt;a href="vote.php?poll_id=4567&amp;candidate=green&amp;candidate=white"&gt;Vote for Mr. White&lt;a&gt;<br />&lt;a href="vote.php?poll_id=4567&amp;candidate=green&amp;candidate=green"&gt;Vote for Mrs. Green&lt;a&gt;
</p>
<h2>REFERENCES</h2>
<p>
  
</p>