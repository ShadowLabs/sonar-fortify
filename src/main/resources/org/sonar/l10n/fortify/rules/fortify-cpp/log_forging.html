<h2>ABSTRACT</h2>
<p>
  Writing unvalidated user input to log files could allow an attacker to forge log entries or inject malicious content into the logs.
</p>
<h2>EXPLANATION</h2>
<p>
  Log forging vulnerabilities occur when:<br /><br />1. Data enters an application from an untrusted source. <br /><p><br />In this case the data enters at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>. <br /></p><br />2. The data written to an application or system log file. <br /><p><br />In this case the data logged by <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br />Applications typically use log files to store a history of events or transactions for later review, statistics gathering, or debugging. Depending upon the nature of the application, log files can be reviewed manually as required, or culled automatically by tools that search the logs for important data points or trends.<br /><br />Examination of the log files can be hindered or conclusions based on log data can be wrong if an attacker is allowed to supply data to the application that is subsequently logged verbatim. An attacker might insert false entries into the log file by including log entry separator characters in their data. If the log file is processed automatically, the attacker can render the file unusable by corrupting the format of the file or injecting unexpected characters. A more subtle attack might involve skewing the log file statistics. Forged or otherwise, corrupted log files can be used to cover an attacker's tracks or even to implicate another party in the commission of a malicious act [1]. In the worst case, an attacker injects code or other commands into the log file and takes advantage of a vulnerability in the log processing utility [2].<br /><br /><b>Example:</b> The following code from a CGI script accepts a string submitted by the user and attempts to convert it into the long integer value it represents. If the value fails to parse as an integer, then its value is logged with an error message indicating what happened.<br /><br /><pre><br />long value = strtol(val, &amp;endPtr, 10);<br />if (*endPtr != '\0')<br />	syslog(LOG_INFO,"Illegal value = %s",val);<br />...<br /><br /></pre><br /><br />If a user submits the string "<code>twenty-one</code>" for <code>val</code>, the following entry is logged:<br /><br /><pre><br />Illegal value=twenty-one<br /></pre><br /><br />However, if an attacker submits the string "<code>twenty-one\n\nINFO: User logged out=evil</code>", the following entry is logged:<br /><br /><pre><br />	INFO: Illegal value=twenty-one<br /><br />	INFO: User logged out=evil<br /></pre><br /><br />Clearly, the attacker can use this same mechanism to insert arbitrary log entries. For this type of log forging attack to be effective, an attacker must first identify valid log entry formats, but this can often be accomplished by through system information leaks in the target application.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>