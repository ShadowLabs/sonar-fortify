<h2>ABSTRACT</h2>
<p>
  Commingling trusted and untrusted data in the same data structure encourages programmers to mistakenly trust unvalidated data.
</p>
<h2>EXPLANATION</h2>
<p>
  A trust boundary can be thought of as line drawn through a program. On one side of the line, data is untrusted. On the other side of the line, data is assumed to be trustworthy. The purpose of validation logic is to allow data to safely cross the trust boundary--to move from untrusted to trusted.<br /><br />A trust boundary violation occurs when a program blurs the line between what is trusted and what is untrusted. The most common way to make this mistake is to allow trusted and untrusted data to commingle in the same data structure. <br /><p><br />In this case the untrusted data enters at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>. The data is added to what is generally used as a trusted data structure at the call to <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br /><b>Example:</b> The following code accepts a <code>usrname</code> cookie and stores its value in the HTTP DB session before it verifies that the user has been authenticated.<br /><br /><pre><br />...<br />IF (OWA_COOKIE.get('usrname').num_vals != 0) THEN<br />usrname := OWA_COOKIE.get('usrname').vals(1);<br />END IF;<br />IF (v('ATTR_USR') IS null) THEN<br />HTMLDB_UTIL.set_session_state('ATTR_USR', usrname);<br />END IF;<br />...<br /></pre><br /><br />Without well-established and maintained trust boundaries, programmers will inevitably lose track of which pieces of data have been validated and which have not. This confusion will eventually allow some data to be used without first being validated.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>