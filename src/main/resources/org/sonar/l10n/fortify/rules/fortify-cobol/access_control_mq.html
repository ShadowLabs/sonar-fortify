<h2>ABSTRACT</h2>
<p>
  Allowing user input to control the fields of the MQ object descriptor could enable an attacker to access or modify otherwise protected MQ resources.
</p>
<h2>EXPLANATION</h2>
<p>
  If an attacker can supply values that the application then uses to determine what kinds of authorization checks to perform on opening an MQ object, the potential exists for an attacker to pass all the access control checks when attempting to open otherwise inaccessible object.<br /><br /><p><br />In this case, the untrusted data enters the program at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/> and is passed to <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br /><br /><b>Example:</b> The following COBOL code snippet reads values from the terminal and uses them to control <code>MQOD-ALTERNATEUSERID</code> and <code>MQOD-ALTERNATESECURITYID</code> fields of the MQ object descriptor.<br /><br /><pre><br />...<br />10 MQOD.<br />**    Alternate user identifier<br />   15 MQOD-ALTERNATEUSERID     PIC X(12).<br />**    Alternate security identifier<br />   15 MQOD-ALTERNATESECURITYID PIC X(40).<br />   ...<br />...<br />ACCEPT MQOD-ALTERNATEUSERID.<br />ACCEPT MQOD-ALTERNATESECURITYID.<br />CALL 'MQOPEN' USING HCONN, MQOD, OPTS, HOBJ, COMPOCODE REASON.<br />... <br /></pre><br /><br />In this example, an attacker could supply values that allow them to pass access control checks on the MQ object eing opened.<br /><br />In general, do not allow user-provided or otherwise untrusted data to control sensitive values.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>