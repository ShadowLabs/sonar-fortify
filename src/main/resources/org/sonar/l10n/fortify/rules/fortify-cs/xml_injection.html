<h2>ABSTRACT</h2>
<p>
  Writing unvalidated data into an XML document can allow an attacker to change the structure and contents of the XML.
</p>
<h2>EXPLANATION</h2>
<p>
  XML injection occurs when:<br /><br />1. Data enters a program from an untrusted source.<br /><p><br />In this case the data enters at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>.<br /></p><br /><IfDef var="ConditionalDescriptions"><br /> <p><br />  <ConditionalText condition="taint:number"><br />Even though the data in this case is a number, it is unvalidated and thus still considered malicious, hence the vulnerability is still reported but with reduced priority values.<br />  </ConditionalText><br /> </p><br /></IfDef><br /><br />2. The data is written to an XML document. <br /><p><br />In this case the XML is written by <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br />Applications typically use XML to store data or send messages. When used to store data, XML documents are often treated like databases and can potentially contain sensitive information. XML messages are often used in web services and can also be used to send sensitive information. XML message can even be used to send authentication credentials.<br /><br />The semantics of XML documents and messages can be altered if an attacker has the ability to write raw XML. In the most benign case, an attacker may be able to insert extraneous tags and cause an XML parser to throw an exception. In more nefarious cases of XML injection, an attacker might be able to add XML elements that change authentication credentials or modify prices in an XML e-commerce database. In some cases, XML injection can even lead to Cross-Site Scripting or Dynamic Code Evaluation.<br /><br /><b>Example 1:</b> <br /><br />Assume an attacker is able to control <code>shoes</code> in following XML.<br /><pre><br />&lt;order&gt;<br />   &lt;price&gt;100.00&lt;/price&gt;<br />   &lt;item&gt;shoes&lt;/item&gt;<br />&lt;/order&gt;<br /></pre><br /><br />Now imagine this XML is included in a back end web service request to place an order for a pair of shoes. Suppose the attacker modifies his request and replaces <code>shoes</code> with <code>shoes&lt;/item&gt;&lt;price&gt;1.00&lt;/price&gt;&lt;item&gt;shoes</code>. The new XML would look like:<br /><pre><br />&lt;order&gt;<br />   &lt;price&gt;100.00&lt;/price&gt;<br />   &lt;item&gt;shoes&lt;/item&gt;&lt;price&gt;1.00&lt;/price&gt;&lt;item&gt;shoes&lt;/item&gt;<br />&lt;/order&gt;<br /></pre><br /><br />When using SAX parsers, the value from the second <code>&lt;price&gt;</code> overrides the value from the first <code>&lt;price&gt;</code> tag. This allows the attacker to purchase a pair of $100 shoes for $1.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>