<h2>ABSTRACT</h2>
<p>
  Writing unvalidated user input to log files can allow an attacker to forge log entries or inject malicious content into the logs.
</p>
<h2>EXPLANATION</h2>
<p>
  Log forging vulnerabilities occur when:<br /><br />1. Data enters an application from an untrusted source.<br /><p><br />In this case the data enters at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>.<br /></p><br />2. The data is written to an application or system log file.<br /><p><br />In this case the data is logged by <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br />Applications typically use log files to store a history of events or transactions for later review, statistics gathering, or debugging. Depending on the nature of the application, the task of reviewing log files may be performed manually on an as-needed basis or automated with a tool that automatically culls logs for important events or trending information.<br /><br />Interpretation of the log files may be hindered or misdirected if an attacker can supply data to the application that is subsequently logged verbatim. In the most benign case, an attacker may be able to insert false entries into the log file by providing the application with input that includes appropriate characters. If the log file is processed automatically, the attacker can render the file unusable by corrupting the format of the file or injecting unexpected characters. A more subtle attack might involve skewing the log file statistics. Forged or otherwise, corrupted log files can be used to cover an attacker's tracks or even to implicate another party in the commission of a malicious act [1]. In the worst case, an attacker may inject code or other commands into the log file and take advantage of a vulnerability in the log processing utility [2].<br /><br /><b>Example:</b> The following web application code attempts to read a value from a request object. The value then is logged.<br /><br /><pre><br />...<br />DATA log_msg TYPE bal_s_msg.<br /><br />val = request->get_form_field( 'val' ).<br /><br />log_msg-msgid = 'XY'.<br />log_msg-msgty = 'E'.<br />log_msg-msgno = '123'.<br />log_msg-msgv1 = 'VAL: '.<br />log_msg-msgv2 = val.<br /><br />CALL FUNCTION 'BAL_LOG_MSG_ADD'<br />  EXPORTING<br />    I_S_MSG          = log_msg<br />  EXCEPTIONS<br />    LOG_NOT_FOUND    = 1<br />    MSG_INCONSISTENT = 2<br />    LOG_IS_FULL      = 3<br />    OTHERS           = 4.<br />...<br /></pre><br /><br />If a user submits the string "<code>FOO</code>" for <code>val</code>, the following entry is logged:<br /><br /><pre><br />XY E 123 VAL: FOO<br /></pre><br /><br />However, if an attacker submits the string "<code>FOO XY E 124 VAL: BAR</code>", the following entry is logged:<br /><br /><pre><br />XY E 123 VAL: FOO XY E 124 VAL: BAR<br /></pre><br /><br />Clearly, attackers can use this same mechanism to insert arbitrary log entries.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>