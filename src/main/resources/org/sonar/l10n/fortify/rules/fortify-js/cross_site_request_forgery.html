<h2>ABSTRACT</h2>
<p>
  HTTP requests must contain a user-specific secret in order to prevent an attacker from making unauthorized requests.
</p>
<h2>EXPLANATION</h2>
<p>
  A cross-site request forgery (CSRF) vulnerability occurs when:<br />1. A web application uses session cookies.<br /><br />2. The application acts on an HTTP request without verifying that the request was made with the user's consent.<br /><br /><p><br />In this case the application generates an HTTP request at <Replace key="PrimaryLocation.file"/> line <Replace key="PrimaryLocation.line"/>.<br /></p><br /><br />If the request does not contain a nonce that proves its provenance, the code that handles the request is vulnerable to a CSRF attack (unless it does not change the state of the application.)  This means a web application that uses session cookies has to take special precautions in order to ensure that an attacker can't trick users into submitting bogus requests. Imagine a web application that allows administrators to create new accounts as follows:<br /><br /><pre><br />  var req = new XMLHttpRequest();<br />  req.open("POST", "/new_user", true);<br />  body = addToPost(body, new_username);<br />  body = addToPost(body, new_passwd);<br />  req.send(body); <br /></pre><br /><br />An attacker might set up a malicious web site that contains the following code.<br /><br /><pre><br />  var req = new XMLHttpRequest();<br />  req.open("POST", "http://www.example.com/new_user", true);<br />  body = addToPost(body, "attacker");<br />  body = addToPost(body, "haha");<br />  req.send(body); <br /></pre><br /><br />If an administrator for the vulnerable site visits a page containing this code while she has an active session, she will unwittingly create an account for the attacker. This is a CSRF attack. It is possible because the application does not have a way to determine the provenance of the request. Any request could be a legitimate action chosen by the user or a faked action set up by an attacker. The attacker does not get to see the web page that the bogus request generates, so the attack technique is only useful for requests that alter the state of the application.<br /><br />Most web browsers send an HTTP header named <code>referer</code> along with each request. The <code>referer</code> header is supposed to contain the URL of the referring page, but attackers can forge it, so the referer header is not useful for determining the provenance of a request.<br /><br />Applications that pass the session identifier on the URL rather than as a cookie do not have CSRF problems because there is no way for the attacker to access the session identifier and include it as part of the bogus request.<br /><br />CSRF is entry number five on the 2007 OWASP Top 10 list.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>