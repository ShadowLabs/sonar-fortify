<h2>ABSTRACT</h2>
<p>
  Allowing user input to control paths used in filesystem operations could enable an attacker to access or modify otherwise protected system resources.
</p>
<h2>EXPLANATION</h2>
<p>
  Path manipulation errors occur when the following two conditions are met:<br /><br />1. An attacker can specify a path used in an operation on the filesystem.<br /><br />2. By specifying the resource, the attacker gains a capability that would not otherwise be permitted.<br /><br />For example, the program may give the attacker the ability to overwrite the specified file or run with a configuration controlled by the attacker.<br /><p><br />In this case, the attacker can specify the value that enters the program at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>, and this value is used to access a filesystem resource at <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br /><b>Example 1:</b> The following code uses input from an HTTP request to create a file name. The programmer has not considered the possibility that an attacker could provide a file name such as "<code>../../tomcat/conf/server.xml</code>", which causes the application to delete one of its own configuration files.<br /><br /><pre><br />var rName = document.URL.indexOf("reportName=")+10;<br />window.requestFileSystem(window.TEMPORARY, 1024*1024, function(fs) {<br />  fs.root.getFile('/usr/local/apfr/reports/' + rName, {create: false}, function(fileEntry) {<br />    fileEntry.remove(function() {<br />      console.log('File removed.');<br />    }, errorHandler);<br /><br />  }, errorHandler);<br />}, errorHandler);<br /></pre><br /><br /><b>Example 2:</b> The following code uses input from the local storage to determine which file to open and echo back to the user. If malicious users can change the contents of the local storage, they can use the program to read any file on the system that ends with the extension <code>.txt</code>.<br /><br /><pre><br />...<br />var filename = localStorage.sub + '.txt';<br />function oninit(fs) {<br />  fs.root.getFile(filename, {}, function(fileEntry) {<br />    fileEntry.file(function(file) {<br />       var reader = new FileReader();<br />       reader.onloadend = function(e) {<br />         var txtArea = document.createElement('textarea');<br />         txtArea.value = this.result;<br />         document.body.appendChild(txtArea);<br />       };<br />       reader.readAsText(file);<br />    }, errorHandler);<br />  }, errorHandler);<br />}<br /><br />window.requestFileSystem(window.TEMPORARY, 1024*1024, oninit, errorHandler);<br />...<br /></pre>
</p>
<h2>REFERENCES</h2>
<p>
  
</p>