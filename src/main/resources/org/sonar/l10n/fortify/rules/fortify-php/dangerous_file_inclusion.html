<h2>ABSTRACT</h2>
<p>
   Allowing unvalidated user input to to control files that are included dynamically in PHP can lead to malicious code execution.
</p>
<h2>EXPLANATION</h2>
<p>
  Many modern web scripting languages enable code re-use and modularization through the ability to include additional source files within one encapsulating file. This ability is often used to apply a standard look and feel to an application (templating), share functions without the need for compiled code, or break the code into smaller more manageable files. Included files are interpreted as part of the parent file and executed in the same manner. File inclusion vulnerabilities occur when the path of the included file is controlled by unvalidated user input. <br /><IfDef var="ConditionalDescriptions"><br /> <p><br />  <ConditionalText condition="taint:number"><br />Even though the data in this case is a number, it is unvalidated and thus still considered malicious, hence the vulnerability is still reported but with reduced priority values.<br />  </ConditionalText><br /> </p><br /></IfDef><br /><br />File inclusion vulnerabilities are one of the most prolific and severe vulnerabilities in PHP applications. Prior to PHP 4.2.0, PHP installations shipped with the <code>register_globals</code> option enabled by default, which permits attackers to easily overwrite internal server variables. Although disabling <code>register_globals</code> can limit a program's exposure to file inclusion vulnerabilities, these problems still occur in modern PHP applications.  <br /><br /><b>Example 1:</b> The following code includes a file under the application defined <code>$server_root</code> in a template. <br /><br /><pre><br />...<br />&lt;?php include($server_root . '/myapp_header.php'); ?$gt;<br />...<br /></pre><br /><br />If <code>register_globals</code> is set to <code>on</code>, an attacker can overwrite the <code>$server_root</code> value by supplying <code>$server_root</code> as a request parameter, thereby taking partial-control of the dynamic include statement.  <br /><br /><b>Example 2:</b> The following code takes a user specified template name and includes it in the PHP page to be rendered. <br /><br /><pre><br />...<br />&lt;?php include($_GET['headername']); ?$gt;<br />...<br /></pre><br /><br />In Example 2, an attacker can take complete control of the dynamic include statement by supplying a malicious value for <code>headername</code> that causes the program to include a file from an external site. <br /><br />If the attacker specifies a valid file to a dynamic include statement, the contents of that file will be passed to the PHP interpreter. In the case of a plain text file, such as <code>/etc/shadow</code>, the file might be rendered as part of the HTML output. Worse, if the attacker can specify a path to a remote site controlled by the attacker, then the dynamic include statement will execute arbitrary malicious code supplied by the attacker.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>