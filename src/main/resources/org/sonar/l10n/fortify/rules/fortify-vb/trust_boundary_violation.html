<h2>ABSTRACT</h2>
<p>
  Commingling trusted and untrusted data in the same data structure encourages programmers to mistakenly trust unvalidated data.
</p>
<h2>EXPLANATION</h2>
<p>
  A trust boundary can be thought of as line drawn through a program. On one side of the line, data is untrusted. On the other side of the line, data is assumed to be trustworthy. The purpose of validation logic is to allow data to safely cross the trust boundary--to move from untrusted to trusted.<br /><br />A trust boundary violation occurs when a program blurs the line between what is trusted and what is untrusted. The most common way to make this mistake is to allow trusted and untrusted data to commingle in the same data structure. <br /><br /><p><br />In this case the untrusted data enters at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>. The data is added to what is generally used as a trusted data structure at the call to <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br /><br /><b>Example:</b> The following code accepts an HTTP request and stores the <code>usrname</code> parameter in the HTTP session object before checking to ensure that the user has been authenticated.<br /><br /><pre><br />...<br />Dim Response As Response<br />Dim Request As Request<br />Dim Session As Session<br />Dim Application As Application<br />Dim Server As Server<br />Dim usrname as Variant<br />Set Response = objContext("Response") <br />Set Request = objContext("Request") <br />Set Session = objContext("Session") <br />Set Application = objContext("Application")<br /><br />usrname = Request.Form("usrname")<br />If IsNull(Session("ATTR_USR")) Then<br />	Session("ATTR_USR") = usrname<br />End If<br />...<br /></pre><br /><br />Without well-established and maintained trust boundaries, programmers will inevitably lose track of which pieces of data have been validated and which have not. This confusion will eventually allow some data to be used without first being validated.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>