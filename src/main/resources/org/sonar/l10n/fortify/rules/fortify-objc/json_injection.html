<h2>ABSTRACT</h2>
<p>
  The method writes unvalidated input into JSON. This call could allow an attacker to inject arbitrary elements or attributes into the JSON entity.
</p>
<h2>EXPLANATION</h2>
<p>
  JSON injection occurs when:<br /><br />1. Data enters a program from an untrusted source.<br /><p><br />In this case the data enters at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>.<br /></p><br /><IfDef var="ConditionalDescriptions"><br /> <p><br />  <ConditionalText condition="taint:number"><br />Even though the data in this case is a number, it is unvalidated and thus still considered malicious, hence the vulnerability is still reported but with reduced priority values.<br />  </ConditionalText><br /> </p><br /></IfDef><br /><br />2. The data is written to a JSON stream. <br /><p><br />In this case the JSON is written by <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br />Applications typically use JSON to store data or send messages. When used to store data, JSON entities are often treated like cached data and can potentially contain sensitive information. JSON messages are often used in RESTFUL services and can also be used to transmit sensitive information. JSON message can even be used to send authentication credentials.<br /><br />The semantics of JSON documents and messages can be altered if an attacker has the ability to write unfiltered input into JSON elements or attributes. In the most benign case, an attacker might be able to insert extraneous attributes and cause an JSON parser to throw an exception. In more nefarious cases of JSON injection, an attacker might be able to add JSON elements that change authentication credentials or modify prices in an JSON request. In some cases, JSON injection can lead to Cross-Site Scripting or Dynamic Code Evaluation.<br /><br /><b>Example 1:</b> The following code takes user input (firstNameField, lastNameField, ssnField) and directly concatenates the values in JSON request strings:<br /><br />NSDictionary *accountInfo = [[NSDictionary alloc] initWithObjectsAndKeys:<br />								 firstNameField.text, @"firstName",<br />								 lastNameField.text, @"lastName",<br />								 ssnField.text, @"socialSecurityNumber", nil];<br />	<br />NSString *jsonString = [[NSString alloc] initWithString:[jsonWriter stringWithObject:accountInfo]];<br /><br /><br />This could allow an attacker to change the fundamental structure of the JSON output.  For example, assume an attacker is able to control <code>shoes</code> in following JSON.<br /><pre><br /><br />{  "order": {<br />	"item":"shoes",<br />	"price": 100.00	<br />   }<br /><br />}<br /><br /></pre><br /><br />Now imagine this JSON is included in a back end RESTFUL service request to place an order for a pair of shoes. Suppose the attacker modifies his request and replaces <code>shoes</code> with <code>shoes","price":1 }, "xorder" : { "item" : "socks </code>. The new JSON would look like:<pre><br />{  "order": {<br />	"item":"shoes",<br />	"price": 1 },<br />    "xorder" : { "item" : "socks",<br />		 "price" : 100.00	<br />   }<br /><br />}<br /><br /></pre><br /><br />The attacker can place a fake JSON object attribute "xorder" to get rid of the price $100.00 attribute. This allows the attacker to purchase a pair of $100 shoes for $1.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>