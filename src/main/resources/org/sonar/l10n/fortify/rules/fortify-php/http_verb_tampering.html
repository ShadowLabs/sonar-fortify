<h2>ABSTRACT</h2>
<p>
  Security constraints that specify HTTP verbs often allow more access than intended.
</p>
<h2>EXPLANATION</h2>
<p>
  An application's authentication and authorization mechanisms can be bypassed with HTTP verb tampering when:<br />1) It uses a security control that lists HTTP verbs.<br />2) The security control fails to block verbs that are not listed.<br />3) The application updates its state based on GET requests or other arbitrary HTTP verbs.<br /><br /><p><br />In this case an <code>&lt;http-method&gt;</code> tag is defined in <Replace key="PrimaryLocation.file"/> at line <Replace key="PrimaryLocation.line"/>.<br /></p><br /><br />Most Java EE implementations implementations allow HTTP methods that are not explicitly listed in the configuration. For example the following security constraint is applied to the HTTP GET method but not other HTTP verbs:<br /><br /><pre><br />    &lt;security-constraint&gt;<br />        &lt;display-name&gt;Admin Constraint&lt;/display-name&gt;<br />        &lt;web-resource-collection&gt;<br />            &lt;web-resource-name&gt;Admin Area&lt;/web-resource-name&gt;<br />            &lt;url-pattern&gt;/pages/index.jsp&lt;/url-pattern&gt;<br />            &lt;url-pattern&gt;/admin/*.do&lt;/url-pattern&gt;<br />            &lt;http-method&gt;GET&lt;/http-method&gt;<br />            &lt;http-method&gt;POST&lt;/http-method&gt;<br />        &lt;/web-resource-collection&gt;<br />        &lt;auth-constraint&gt;<br />            &lt;description&gt;only admin&lt;/description&gt;<br />            &lt;role-name&gt;admin&lt;/role-name&gt;<br />        &lt;/auth-constraint&gt;<br />    &lt;/security-constraint&gt;<br /></pre><br /><br />Since verbs like HEAD are not explicitly defined in an <code>&lt;http-method&gt;</code> tag in this configuration, it might be possible to exercise administrative functionality by substituting GET or POST requests with HEAD requests. For HEAD requests to exercise administrative functionality, condition 3 must hold - the application must carry out commands based on verbs other than POST. Some web/application servers will accept arbitrary non-standard HTTP verbs and respond as if they were given a GET request. If that is the case, an attacker would be able to view administrative pages by using an arbitrary verb in a request.<br /><br />For example, a typically client GET requests looks like:<br /><pre><br />GET /admin/viewUsers.do HTTP/1.1<br />Host: www.example.com<br /></pre><br /><br />In an HTTP Verb Tampering attack, an attacker would substitute GET with something like FOO<br /><pre><br />FOO /admin/viewUsers.do HTTP/1.1<br />Host: www.example.com<br /></pre><br /><br />At its core, this vulnerability is the result of an attempt to create a blacklist--a policy that specifies what users are not allowed to do. Blacklists rarely achieve their intended effect.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>