<h2>ABSTRACT</h2>
<p>
  Without proper access control, executing an LDAP statement that contains a user-controlled value can allow an attacker to access unauthorized directory entries.
</p>
<h2>EXPLANATION</h2>
<p>
  Database access control errors occur when:<br /><br />1.	Data enters a program from an untrusted source.<br /><p><br />In this case the data enters at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>. <br /></p><br />2.	The data is used to specify a data value in an LDAP query. <br /><p><br />In this case the data is used by <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br /><b>Example 1:</b> The employee ID of the current authenticated user is automatically submitted with each request by the client-side interface. The following code properly validates an employee name using a whitelist before using it to construct an LDAP query. This validation prevents LDAP injection vulnerabilities, but may still leave the code vulnerable. <br /><br /><pre><br />...<br />string whitelist = @"^[a-zA-Z\-\.']$";            <br />string employee = empName.Text.trim();         <br />Regex pattern = new Regex(whitelist); <br />           <br />if(!pattern.IsMatch(employee)) {<br />  DirectorySearcher src = <br />           new DirectorySearcher("(empID=" + employee + ")");<br />  src.SearchRoot = de;<br />  src.SearchScope = SearchScope.Subtree;<br /><br />  foreach(SearchResult res in src.FindAll()) {<br />    ... <br />  }<br />}<br /></pre><br /><br />The problem is that the developer has failed to consider what would happen if an attacker provides alternate values of <code>empName</code>. Although the interface automatically submits the employee ID of the current user, an attacker could submit an alternative value as part of a malicious request. Because the code in this example executes the query under an anonymous bind, it will return the directory entry for any valid employee ID, regardless of the identity of the current authenticated user.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>