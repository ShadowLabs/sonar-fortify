<h2>ABSTRACT</h2>
<p>
  The identified method allows external entity references. This call could allow an attacker to inject an xml external entity into the XML document to reveal the contents of files or internal network resources.
</p>
<h2>EXPLANATION</h2>
<p>
  XML external entity injection occurs when:<br /><br />1. Data enters a program from an untrusted source.<br /><br />2. The data is written to an &lt;ENTITY&gt; element of the DTD (Document Type Definition) in an XML document. <br /><br />Applications typically use XML to store data or send messages. When used to store data, XML documents are often treated like databases and can potentially contain sensitive information. XML messages are often used in web services and can also be used to transmit sensitive information. XML message can even be used to send authentication credentials.<br /><br />The semantics of XML documents and messages can be altered if an attacker has the ability to write raw XML. In the most benign case, an attacker might be able to insert nested entity references and cause an XML parser consume ever increasing amounts of CPU resources. In more nefarious cases of XML external entity injection (XXE), an attacker might be able to add XML elements that expose the contents of local file system resources or reveal the existence of internal network resources. <br /><br /><b>Example 1:</b>Here is some code that is vulnerable to XXE attacks:<br /><br /><pre><br />- (void) parseSomeXML: (NSString *) rawXml {<br />    <br />    BOOL success;<br />    NSData *rawXmlConvToData = [rawXml dataUsingEncoding:NSUTF8StringEncoding];<br />    NSXMLParser *myParser = [[NSXMLParser alloc] initWithData:rawXmlConvToData];<br />    [myParser setShouldResolveExternalEntities:YES];<br />    [myParser setDelegate:self];<br />}<br /></pre><br /><br />Assume an attacker is able to control rawXml such that the xml looks like the following:<br /><br /><pre><br /> &lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;<br /> &lt;!DOCTYPE foo [  <br />   &lt;!ELEMENT foo ANY &gt;<br />   &lt;!ENTITY xxe SYSTEM "file:///c:/boot.ini" &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;<br /></pre><br /><br />When the XML is evaluated by the server, the &lt;foo&gt; element will contain the contents of the boot.ini file.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>