<h2>ABSTRACT</h2>
<p>
  Loading libraries from an untrusted source or in an untrusted environment can cause an application to execute malicious commands on behalf of an attacker. 
</p>
<h2>EXPLANATION</h2>
<p>
  Process control vulnerabilities take two forms:<br /><br />- An attacker can change the name of the library that the program loads: the attacker explicitly controls what the name of the library is.<br /><br />- An attacker can change the environment in which the library loads: the attacker implicitly controls what the library name means.<br /><br />In this case we are primarily concerned with the first scenario, the possibility that an attacker may be able to control the name of the library that is loaded. Process control vulnerabilities of this type occur when:<br /><br />1. Data enters the application from an untrusted source.<br /><br /><p><br />In this case the data enters at <Replace key="SourceFunction" link="SourceLocation"/> in <Replace key="SourceLocation.file"/> at line <Replace key="SourceLocation.line"/>.<br /></p><br /><br />2. The data is used as or as part of a string representing a library that is loaded by the application. <br /><br /><p><br />In this case the library is loaded by <Replace key="SinkFunction" link="SinkLocation"/> in <Replace key="SinkLocation.file"/> at line <Replace key="SinkLocation.line"/>.<br /></p><br /><br />3. By executing code from the library, the application gives the attacker a privilege or capability that the attacker would not otherwise have. <br /><br /><b>Example 1:</b> The following code from a privileged system utility uses the system property <code>APPHOME</code> to determine the directory in which it is installed and then loads a native library based on a relative path from the specified directory.<br /><br /><pre><br />...<br />	String home = System.getProperty("APPHOME");<br />	String lib = home + LIBNAME; <br />	java.lang.Runtime.getRuntime().load(lib);<br />	...<br /></pre><br /><br />This code allows an attacker to load a library and potentially execute arbitrary code with the elevated privilege of the application by modifying the system property <code>APPHOME</code> to point to a different path containing a malicious version of <code>LIBNAME</code>. Because the program does not validate the value read from the environment, if an attacker can control the value of the system property <code>APPHOME</code>, then they can fool the application into running malicious code and take control of the system. <br /><br /><b>Example 2:</b> The following code uses <code>System.loadLibrary()</code> to load code from a native library named <code>library.dll</code>, which is normally found in a standard system directory. <br /><br /><pre><br />...<br />System.loadLibrary("library.dll");<br />...<br /></pre><br /><br />The problem here is that <code>System.loadLibrary()</code> accepts a library name, not a path, for the library to be loaded. From the Java 1.4.2 API documentation this function behaves as follows [1]:<br /><br />A file containing native code is loaded from the local file system from a place where library files are conventionally obtained. The details of this process are implementation-dependent. The mapping from a library name to a specific filename is done in a system-specific manner.<br /><br />If an attacker is able to place a malicious copy of <code>library.dll</code> higher in the search order than file the application intends to load, then the application will load the malicious copy instead of the intended file. Because of the nature of the application, it runs with elevated privileges, which means the contents of the attacker's <code>library.dll</code> will now be run with elevated privileges, possibly giving them complete control of the system.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>