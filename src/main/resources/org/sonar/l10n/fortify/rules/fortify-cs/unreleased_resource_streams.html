<h2>ABSTRACT</h2>
<p>
  The program can potentially fail to release a system resource.
</p>
<h2>EXPLANATION</h2>
<p>
  The program can potentially fail to release a system resource. <br /><br />Resource leaks have at least two common causes:<br /><br />- Error conditions and other exceptional circumstances.<br /><br />- Confusion over which part of the program is responsible for releasing the resource.<br /><p><br />In this case, there are program paths on which the resource allocated in <Replace key="FirstTraceLocation.file"/> at line <Replace key="FirstTraceLocation.line"/> is not released.<br /></p><br />Most unreleased resource issues result in general software reliability problems, but if an attacker can intentionally trigger a resource leak, the attacker might be able to launch a denial of service attack by depleting the resource pool.<br /><br /><b>Example 1:</b> The following method never closes the file handle it opens. The <code>Finalize()</code> method for <code>StreamReader</code> eventually calls <code>Close()</code>, but there is no guarantee as to how long it will take before the <code>Finalize()</code> method is invoked. In fact, there is no guarantee that <code>Finalize()</code> will ever be invoked. In a busy environment, this can result in the VM using up all of its available file handles.<br /><br /><pre><br />private void processFile(string fName) {<br />	StreamWriter sw = new StreamWriter(fName);<br />	string line;<br />	while ((line = sr.ReadLine()) != null) <br />		processLine(line);<br />}<br /></pre><br /><br /><b>Example 2:</b> Under normal conditions the following code executes a database query, processes the results returned by the database, and closes the allocated <code>SqlConnection</code> object. But if an exception occurs while executing the SQL or processing the results, the <code>SqlConnection</code> object is not closed. If this happens often enough, the database will run out of available cursors and not be able to execute any more SQL queries.<br /><br /><pre><br />        ...<br />	SqlConnection conn = new SqlConnection(connString);<br />	SqlCommand cmd = new SqlCommand(queryString);<br />	cmd.Connection = conn;<br />	conn.Open();<br />	SqlDataReader rdr = cmd.ExecuteReader();<br />	HarvestResults(rdr); <br />	conn.Connection.Close();<br />	...<br /></pre>
</p>
<h2>REFERENCES</h2>
<p>
  
</p>