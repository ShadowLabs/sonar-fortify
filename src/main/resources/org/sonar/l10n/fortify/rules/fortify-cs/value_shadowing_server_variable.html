<h2>ABSTRACT</h2>
<p>
  The program accesses a server variable in an ambiguous way, which can leave it open to attack.
</p>
<h2>EXPLANATION</h2>
<p>
  The <code>HttpRequest</code> class provides programatic access to variables from the <code>QueryString</code>, <code>Form</code>, <code>Cookies</code> or <code>ServerVariables</code> collections in the form of an array access (e.g. <code>Request["myParam"]</code>). When more than one variable exists with the same name, the .NET framework returns the value of the variable that appears first when the collections are searched in the following order: <code>QueryString</code>, <code>Form</code>, <code>Cookies</code> then <code>ServerVariables</code>. Because <code>QueryString</code> comes first in the search order, it is possible for <code>QueryString</code> parameters to supersede values from forms, cookies and server variables. Similarly, form values can supersede variables in the <code>Cookies</code> and <code>ServerVariables</code> collections and variables from the <code>Cookies</code> collection can supersede those from <code>ServerVariables</code>. <br /><p><br />In this case, the value of a server variable accessed from an <code>HttpRequest</code> object at line <Replace key="PrimaryLocation.line"/> in <Replace key="PrimaryLocation.file"/> can be superseded by an attacker.<br /></p><br /><br /><b>Example 1:</b> The following code checks the HTTP Referer header server variable to see if the request came from <code>www.example.com</code> before serving content.<br /><pre><br />    ...<br />    if (Request["HTTP_REFERER"].StartsWith("http://www.example.com"))<br />        ServeContent();<br />    else<br />        Response.Redirect("http://www.example.com/");<br />    ...<br /></pre><br /><br />Assume the code above is executed when visiting <code>http://www.example.com/ProtectedImages.aspx</code>. If an attacker makes a direct request to the URL, the appropriate referer header will not be set and the request will fail. However, if the attacker submits an artificial <code>HTTP_REFERER</code> parameter with the necessary value, such as <code>http://www.example.com/ProtectedImages.aspx?HTTP_REFERER=http%3a%2f%2fwww.example.com</code>, then the lookup will return the value from <code>QueryString</code> instead of <code>ServerVariables</code> and the check will succeed.
</p>
<h2>REFERENCES</h2>
<p>
  
</p>